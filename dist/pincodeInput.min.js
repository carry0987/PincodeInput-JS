!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).PincodeInput=t()}(this,(function(){"use strict";var e=Object.freeze({__proto__:null,reportError:function(...e){console.error(...e)},throwError:function(e){throw new Error(e)}});function t(e,t,n){if("string"!=typeof e)return e;let s=document;return null===t&&n?s=n:t&&t instanceof Node&&"querySelector"in t?s=t:n&&n instanceof Node&&"querySelector"in n&&(s=n),"all"===t?s.querySelectorAll(e):s.querySelector(e)}function n(e,t={},n=""){let s=document.createElement(e);for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&("textContent"===e||"innerText"===e?s.textContent=t[e]:s.setAttribute(e,t[e]));return n&&(s.textContent=n),s}function s(e,t){return e.classList.add(t),e}function o(e,t){return e.classList.remove(t),e}function i(e,t,n){return e.classList.toggle(t,n),e}let l="utils-style";const a={from:".utils",to:".utils-"};function r(e){return"object"==typeof e&&null!==e&&!c(e)}function c(e){return Array.isArray(e)}function u(e){return"number"!=typeof e&&("string"==typeof e&&0===e.length||(!(!c(e)||0!==e.length)||(!(!r(e)||0!==Object.keys(e).length)||!e)))}function d(e,...t){if(!t.length)return e;const n=t.shift();if(n)for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=n[t],o=t;r(s)||c(s)?(e[o]&&"object"==typeof e[o]||(e[o]=c(s)?[]:{}),d(e[o],s)):e[o]=s}return d(e,...t)}function p(e){l=e}function h(e,t){a.from=e,a.to=t}function m(e,t=null){t=u(t)?"":t;let s=n("style");s.id=l+t,s.textContent="",document.head.append(s);let o=s.sheet;for(let n in e)e.hasOwnProperty(n)&&g(o,n,f(e[n]),t)}function f(e){let t="";for(let[n,s]of Object.entries(e))n=n.replace(/([A-Z])/g,(e=>`-${e[0].toLowerCase()}`)),t+=`${n}:${s};`;return t}function g(e,t,n,s=null){s=u(s)?"":s;let o=t.replace(a.from,a.to+s);e.insertRule(o+"{"+n+"}",0)}function v(e=null){const n=u(e)?"":e;let s=t("#"+l+n);s&&s.parentNode&&s.parentNode.removeChild(s)}function y(e,t,n,s){e.addEventListener(t,n,s)}class C{static throwError=e.throwError;static deepMerge=d;static setStylesheetId=p;static setReplaceRule=h;static injectStylesheet=m;static removeStylesheet=v;static getElem=t;static createElem=n;static addClass=s;static removeClass=o;static toggleClass=i;static addEventListener=y;static isDigit(e){return/^\d$/.test(e)}static updateVisiblePinCode(e,t,n,s){const o=e.value;C.getElem(".pincode-grid span","all").forEach(((e,t)=>{e.textContent=s&&o[t]?s:o[t]||""})),t?.(e.value,e.value.length-1),e.value.length===e.maxLength&&n?.(e.value)}}C.setStylesheetId("pincodeInput-style"),C.setReplaceRule(".pincodeInput",".pincodeInput");const E={autoFocus:!1,allowEscape:!0,allowPaste:!0,secure:!1,placeHolder:"â€¢",forceDigits:!0,length:6,styles:{},onLoad:()=>{},onInput:(e,t)=>{},onComplete:e=>{}};class b{static instances=[];static version="1.0.12";element;options=E;onInputCallback=void 0;onCompleteCallback=void 0;constructor(e,t={}){this.init(e,t),b.instances.push(this),1===b.instances.length&&((e,t=!1)=>{!0===t?console.log("Data Type : "+typeof e,"\nValue : "+e):"boolean"!=typeof t?console.log(t):console.log(e)})(`PincodeInput is loaded, version: ${b.version}`)}init(e,t){let n;n="string"==typeof e?C.getElem(e):e,n||C.throwError("Element not found"),n instanceof HTMLInputElement||C.throwError("Element must be an input field"),this.element=n,this.options=C.deepMerge({},E,t),this.onInputCallback=t.onInput,this.onCompleteCallback=t.onComplete,this.options?.onLoad?.(),this.createPincodeGrids(b.instances.length)}createPincodeGrids(e){const t=this.options,n=this.element.maxLength>0?this.element.maxLength:t.length;let s={};t.styles&&Object.keys(t.styles).length>0&&(s=C.deepMerge({},t.styles,s)),s&&C.injectStylesheet(s,e.toString());const o=C.createElem("div");o.className="pincodeInput";const i=C.createElem("div");i.className="pincode";for(let e=0;e<n;e++){const t=C.createElem("div"),n=C.createElem("span");t.className="pincode-grid",t.dataset.index=e.toString(),t.appendChild(n),i.appendChild(t)}const l=this.element.parentElement,a=this.element.nextSibling;return l&&(l.removeChild(this.element),a?l.insertBefore(o,a):l.appendChild(o)),C.addClass(this.element,"pincode-input"),this.element.removeAttribute("hidden"),this.element.type=t.secure?"password":"text",this.element.pattern="[0-9]*",this.element.inputMode="numeric",this.element.maxLength=n,this.element.autocomplete="off",o.appendChild(this.element),o.appendChild(i),C.getElem(".pincode-grid","all",o).forEach((e=>{C.addEventListener(e,"click",(()=>this.element.focus()))})),C.addEventListener(this.element,"input",this.onPinInput.bind(this)),C.addEventListener(this.element,"keydown",this.handleKeydown.bind(this)),C.addEventListener(this.element,"paste",this.handlePaste.bind(this)),C.addEventListener(this.element,"focus",(()=>this.updateFocus())),C.addEventListener(this.element,"blur",this.removeFocus.bind(this),!0),t.autoFocus&&this.element.focus(),this}updateFocus(){const e=Array.from(C.getElem(".pincode-grid","all")),t=this.element.value.length;e.forEach(((e,n)=>{this.element.focus(),n===t?C.addClass(e,"pincode-focus"):C.removeClass(e,"pincode-focus")}))}removeFocus(){C.getElem(".pincode-grid","all").forEach((e=>{C.removeClass(e,"pincode-focus")}))}onPinInput(e){const t=e.target;this.options.forceDigits&&t.value&&(t.value=t.value.replace(/\D/g,""));const n=this.options.secure?this.options.placeHolder:void 0;t.value.length<=t.maxLength?(C.updateVisiblePinCode(t,this.onInputCallback,this.onCompleteCallback,n),this.updateFocus()):t.value=t.value.slice(0,t.maxLength)}handleKeydown(e){const t=(e.ctrlKey||e.metaKey)&&"v"===e.key;if(!t)return"Backspace"===e.key?(this.handleBackspace(),void e.preventDefault()):void("Escape"===e.key&&this.options.allowEscape?this.handleEscape():this.options.forceDigits&&!t&&(C.isDigit(e.key)||e.preventDefault()))}handleBackspace(){const e=this.element.value,t=this.options.secure?this.options.placeHolder:void 0;e.length>0&&(this.element.value=e.slice(0,e.length-1),C.updateVisiblePinCode(this.element,this.onInputCallback,this.onCompleteCallback,t),this.updateFocus())}handleEscape(){this.clear(),this.element.blur()}handlePaste(e){if(!this.options.allowPaste)return void e.preventDefault();const t=e.clipboardData;if(!t)return;const n=t.getData("text").slice(0,this.element.maxLength);this.options.forceDigits?this.element.value=n.replace(/\D/g,""):this.element.value=n,C.updateVisiblePinCode(this.element,this.onInputCallback,this.onCompleteCallback,this.options.secure?this.options.placeHolder:void 0),this.updateFocus(),e.preventDefault()}clear(){this.element.value="",this.element.dispatchEvent(new Event("input"))}destroy(){let e=b.instances.indexOf(this);e<0?C.throwError("PincodeInput instance not found"):(C.removeStylesheet(e.toString()),this.element.remove(),b.instances.splice(e,1))}set onInput(e){this.onInputCallback=e}set onComplete(e){this.onCompleteCallback=e}get value(){return this.element.value}}return b}));
